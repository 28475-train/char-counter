<!DOCTYPE html>
<html lang="ja" data-view="" data-ads="true">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ã€SPç‰ˆã€‘ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ</title>
<meta name="description" content="ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ–‡å­—æ•°ã¨è¡Œæ•°ã‚’å³åº§ã«è¨ˆæ¸¬ã™ã‚‹ç„¡æ–™ã®æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«ã€‚">
<link rel="stylesheet" href="../style.css"> <style>
/* SPç‰ˆå‘ã‘ã«ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®ã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
.content-wrapper textarea {
    width: 100%;
    min-height: 200px; /* SPå‘ã‘ã«é«˜ã•ã‚’å›ºå®š */
    box-sizing: border-box;
    padding: 10px;
}
.card {
    padding: 15px;
}
.info p {
    margin: 5px 0;
}
</style>
</head>
<body data-theme="light_green">
<script>
// --- ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ± ---
const APP_VERSION = "v1.2.0"; 
// ----------------------

// SP/PCæŒ¯ã‚Šåˆ†ã‘åˆ¤å®š
const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

if (!isMobile) {
    location.href = '../counter.html'; // PCç‰ˆã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
} else {
    // ãƒšãƒ¼ã‚¸ã‚’ç›´æ¥é–‹ã„ãŸå ´åˆã¯ SP/index.html ã¸æˆ»ã™
    if (!document.referrer.includes('SP/index.html')) {
        location.href = 'index.html'; 
    }
}

// æ—¢å­˜ã®è¨­å®šãƒ­ãƒ¼ãƒ‰ (ãƒ†ãƒ¼ãƒã€åºƒå‘Šãªã©) - ç°¡ç•¥åŒ–
const savedTheme = localStorage.getItem('theme');
if (savedTheme) { document.body.setAttribute('data-theme', savedTheme); }
const hideAds = localStorage.getItem('hideAds') === 'true';
if (hideAds) { document.body.setAttribute('data-ads', 'false'); }


// === æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆãƒ­ã‚¸ãƒƒã‚¯ (PCç‰ˆã¨å…±æœ‰) ===
function updateCount() {
    const textarea = document.getElementById('text');
    const charDisplay = document.getElementById('char');
    const lineDisplay = document.getElementById('line');
    const remainDisplay = document.getElementById('remain');
    const byteCountDisplay = document.getElementById('byteCount');
    const fullWidthCountDisplay = document.getElementById('fullWidthCount');
    const halfWidthCountDisplay = document.getElementById('halfWidthCount');
    
    let text = textarea.value;
    const limit = parseInt(document.getElementById('customLimit').value) || 280;
    const ignoreSpaces = localStorage.getItem('ignoreSpaces') === 'true'; 

    if (ignoreSpaces) {
        text = text.replace(/[\s\r\n\t]/g, ''); // ã‚¹ãƒšãƒ¼ã‚¹ã€æ”¹è¡Œã€ã‚¿ãƒ–ã‚’å‰Šé™¤
    }

    // æ–‡å­—æ•°ã€è¡Œæ•°
    const charCount = text.length;
    const lineCount = text.split('\n').length;
    const remainCount = limit - charCount;
    
    charDisplay.textContent = charCount;
    lineDisplay.textContent = lineCount;
    remainDisplay.textContent = remainCount;
    remainDisplay.style.color = remainCount < 0 ? 'red' : 'var(--text-highlight)';

    // ãƒã‚¤ãƒˆæ•°ã€å…¨è§’/åŠè§’ (ç°¡æ˜“è¨ˆç®—)
    let byteCount = 0;
    let fullWidthCount = 0;
    let halfWidthCount = 0;
    
    for (let i = 0; i < text.length; i++) {
        const charCode = text.charCodeAt(i);
        if (charCode >= 0x0000 && charCode <= 0x00FF) { // ASCII/åŠè§’
            byteCount += 1;
            halfWidthCount++;
        } else { // å…¨è§’
            byteCount += 2; // UTF-8ã§æ—¥æœ¬èªã¯ä¸»ã«3ãƒã‚¤ãƒˆã ãŒã€ç°¡æ˜“çš„ã«2ãƒã‚¤ãƒˆã¨ã—ã¦è¨ˆç®—
            fullWidthCount++;
        }
    }
    byteCountDisplay.textContent = byteCount;
    fullWidthCountDisplay.textContent = fullWidthCount;
    halfWidthCountDisplay.textContent = halfWidthCount;
}

// ä¸Šé™æ–‡å­—æ•°è¨­å®š (PCç‰ˆã¨å…±æœ‰)
function setLimit(value) {
    document.getElementById('customLimit').value = value;
    updateCount();
}
function setCustom() {
    const customValue = document.getElementById('customLimit').value;
    if (customValue > 0) {
        setLimit(customValue);
    } else {
        alert('1ä»¥ä¸Šã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
    }
}
function download() { /* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ã¯çœç•¥ */ alert('ä¿å­˜æ©Ÿèƒ½ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒæœªå®Ÿè£…ã§ã™ã€‚'); }
function clearText() { 
    document.getElementById('text').value = ''; 
    updateCount(); 
}

window.onload = function() {
    // åˆæœŸè¨­å®šå€¤ã®ãƒ­ãƒ¼ãƒ‰ (ä¾‹: åˆ¶é™å€¤)
    const customLimitInput = document.getElementById('customLimit');
    customLimitInput.value = localStorage.getItem('charLimit') || 280;
    
    const textarea = document.getElementById('text');
    textarea.addEventListener('input', updateCount);
    updateCount(); // åˆå›å®Ÿè¡Œ
}
</script>

<div class="top-ad-header" style="height: 50px;">
    <div id="ad-area-top-sp">
        AD: SP Top Banner 320x50
    </div>
</div>

<div class="main-content-area">

    <header class="header">
        <div class="menu-toggle" onclick="toggleMenu()">â˜°</div>
        <a href="counter.html" class="header-title" style="font-size: 1.2em;">ğŸ“ ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ (SPç‰ˆ)</a>
    </header>

    <nav class="side-nav" id="sideNav">
        <a href="counter.html" class="active-tab">ğŸ“ æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ</a> 
        <a href="roulette.html">ğŸ² ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</a> 
        <a href="settings.html">âš™ è¨­å®š</a>
        <a href="help.html">ãƒ˜ãƒ«ãƒ—</a>
        <a href="about.html">åˆ¶ä½œè€…</a>
    </nav>
    
    <div class="content-wrapper">
        <h1>æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ ä¿å­˜ãƒ„ãƒ¼ãƒ« (SP)</h1>
        
        <div class="card">
            <div class="controls" style="margin-bottom: 10px;">
              ä¸Šé™æ–‡å­—æ•°ï¼š
              <button onclick="setLimit(140)">140</button>
              <button onclick="setLimit(280)">280</button>
              ã‚«ã‚¹ã‚¿ãƒ 
              <input type="number" id="customLimit" min="1" value="280" style="width:70px">
              <button onclick="setCustom()">è¨­å®š</button>
            </div>
            
            <textarea id="text" placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
            
            <div class="info">
              <p>æ–‡å­—æ•°: <span id="char">0</span></p>
              <p>è¡Œæ•°: <span id="line">1</span></p>
              <p>æ®‹ã‚Šæ–‡å­—æ•°: <span id="remain">280</span></p>

              <hr style="margin: 10px 0; border: none; border-top: 1px dashed var(--border);">
              <p style="font-size: 0.9em;">
                  è©³ç´°:
                  å…¨è§’ <span id="fullWidthCount">0</span>å­— / 
                  åŠè§’ <span id="halfWidthCount">0</span>å­— / 
                  <span style="font-weight: bold;">æ¨å®šãƒã‚¤ãƒˆæ•° <span id="byteCount">0</span> bytes</span>
              </p>
            </div>

            <div class="controls" style="margin-top: 15px; text-align: center;">
              <select id="format" style="padding: 8px;">
                <option value="txt">TXT</option>
                <option value="md">Markdown</option>
                <option value="csv">CSV</option>
              </select>
              <button class="save-btn" onclick="download()">ä¿å­˜</button>
              <button class="clear-btn" onclick="clearText()" style="background-color: #d9534f;">ã™ã¹ã¦ã‚¯ãƒªã‚¢</button>
            </div>

        </div>
        </div>
</div>

<div class="bottom-ad-footer" style="height: 50px;">
    <div id="ad-area-bottom-sp">
        AD: SP Bottom Banner 320x50
    </div>
</div>

<footer class="footer" style="text-align:center; padding: 20px 0; font-size: 0.8em; color: var(--text-soft);">
    <p>Version <span id="appVersionDisplay"></span></p>
</footer>

<script>
function toggleMenu() { document.getElementById('sideNav').classList.toggle('open'); }
document.getElementById('appVersionDisplay').textContent = APP_VERSION;
// (SPç‰ˆã«ã¯ã‚¢ã‚¯ã‚»ã‚¹æ•°ãŒå¤šããªã„ãŸã‚ã€è¨ªå•å›æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®è¡¨ç¤ºè¦ç´ ã¯çœç•¥ã—ã¦ã„ã¾ã™)
</script>
</body>
</html>
