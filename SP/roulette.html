<!DOCTYPE html>
<html lang="ja" data-ads="true">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ã€SPç‰ˆã€‘ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ»ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ | ãƒ„ãƒ¼ãƒ«</title>
<link rel="stylesheet" href="../style.css">
<style>
/* ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ/ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³å›ºæœ‰ã®ã‚¹ã‚¿ã‚¤ãƒ« (SPç‰ˆèª¿æ•´) */
.roulette-container {
    background: var(--card);
    padding: 20px 15px; /* SPç‰ˆã«åˆã‚ã›ã¦ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°èª¿æ•´ */
    border-radius: 12px;
    box-shadow: var(--shadow);
    text-align: center;
    margin-top: 15px;
    border: 1px solid var(--border);
}

/* ç›®æ¨™è¡¨ç¤ºã‚¨ãƒªã‚¢ */
#targetDisplay {
    font-size: 1em; /* SPç‰ˆã«åˆã‚ã›ã¦ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ */
    color: var(--text-soft);
    margin-bottom: 15px;
}

/* ã‚«ã‚¦ãƒ³ãƒˆå€¤/ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ */
#countdownValue, #rouletteResult {
    font-size: 3em; /* SPç‰ˆã«åˆã‚ã›ã¦ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ */
    font-weight: 800;
    color: var(--accent-dark);
    margin: 15px 0;
    line-height: 1.2;
    min-height: 80px; 
}

/* ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ */
#rouletteAnimation {
    width: 100%;
    height: 80px; /* SPç‰ˆã«åˆã‚ã›ã¦é«˜ã•èª¿æ•´ */
    background-color: var(--accent-light);
    border-radius: 8px;
    margin: 15px auto;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.3em;
    color: var(--accent-dark);
    border: 3px dashed var(--accent);
}

/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
#startButton {
    padding: 12px 20px;
    font-size: 1.1em; /* SPç‰ˆã«åˆã‚ã›ã¦ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºèª¿æ•´ */
    background-color: var(--accent);
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s;
}

#startButton:hover {
    background-color: var(--accent-dark);
}

/* è¨­å®šã¸ã®èª˜å° */
.settings-link-area {
    margin-top: 20px;
    padding-top: 10px;
    border-top: 1px solid var(--border);
}

/* ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³å®Œäº†å¾Œã®ã‚¹ã‚¿ã‚¤ãƒ« */
.finished {
    color: red !important;
}

/* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆä¾‹ï¼šç‚¹æ»…ï¼‰ */
@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
}

.blinking {
    animation: blink 0.8s infinite;
}
</style>
</head>
<body data-theme="light_green">
<script>
// --- ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ± ---
const APP_VERSION = "v1.2.0"; 
// ----------------------
const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
if (!isMobile) { location.href = '../roulette.html'; }

function toggleMenu() { document.getElementById('sideNav').classList.toggle('open'); }

// â˜…â˜…â˜… æ©Ÿèƒ½å¾©æ—§: ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ/ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ â˜…â˜…â˜…
let countdownInterval;
const defaultTargetDate = new Date();
defaultTargetDate.setDate(defaultTargetDate.getDate() + 7); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯1é€±é–“å¾Œ

function startCountdown() {
    // ä»®ã®ç›®æ¨™æ—¥æ™‚ã‚’ LocalStorage ã¾ãŸã¯ settings.html ã‹ã‚‰å–å¾—ã—ãŸã¨ä»®å®š
    const targetDate = localStorage.getItem('rouletteTargetDate') 
                     ? new Date(localStorage.getItem('rouletteTargetDate')) 
                     : defaultTargetDate;

    // è¡¨ç¤ºã‚’æ›´æ–°
    document.getElementById('targetDisplay').textContent = 
        "ç›®æ¨™æ—¥æ™‚: " + targetDate.toLocaleString();
    
    // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³é–‹å§‹
    clearInterval(countdownInterval);
    
    const update = () => {
        const now = new Date().getTime();
        const distance = targetDate - now;

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        const countdownElement = document.getElementById('countdownValue');
        const startButton = document.getElementById('startButton');

        if (distance < 0) {
            clearInterval(countdownInterval);
            countdownElement.textContent = "ç›®æ¨™é”æˆï¼";
            countdownElement.classList.add('finished', 'blinking');
            startButton.textContent = "ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆé–‹å§‹";
            startButton.disabled = false;
        } else {
            countdownElement.textContent = 
                `${days}æ—¥ ${hours}æ™‚é–“ ${minutes}åˆ† ${seconds}ç§’`;
            startButton.textContent = "ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ä¸­...";
            startButton.disabled = true;
        }
    };

    update();
    countdownInterval = setInterval(update, 1000);
}

function startRoulette() {
    const resultElement = document.getElementById('rouletteResult');
    const animationElement = document.getElementById('rouletteAnimation');
    const startButton = document.getElementById('startButton');

    startButton.disabled = true;
    startButton.textContent = "çµæœã‚’æŠ½é¸ä¸­...";
    resultElement.textContent = "â€¦";
    animationElement.textContent = "é«˜é€Ÿå›è»¢ä¸­ï¼";
    
    // ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (5ç§’å¾Œã«çµæœã‚’å‡ºã™)
    setTimeout(() => {
        const results = ["å¤§æˆåŠŸï¼", "æˆåŠŸ", "å°‘ã—å¤±æ•—", "ã‚„ã‚Šç›´ã—ï¼"];
        const finalResult = results[Math.floor(Math.random() * results.length)];

        resultElement.textContent = finalResult;
        animationElement.textContent = "æŠ½é¸çµ‚äº†";
        startButton.textContent = "ã‚‚ã†ä¸€åº¦ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ";
        startButton.disabled = false;

        if (document.getElementById('countdownValue').textContent !== "ç›®æ¨™é”æˆï¼") {
             startButton.textContent = "ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³å†é–‹";
        }
        
    }, 5000);
}

window.onload = function() { 
    document.getElementById('appVersionDisplay').textContent = APP_VERSION; 
    
    // åˆæœŸè¡¨ç¤ºã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚’é–‹å§‹
    startCountdown();

    // ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã¨ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã®é–‹å§‹ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
    document.getElementById('startButton').addEventListener('click', () => {
        if (document.getElementById('countdownValue').textContent === "ç›®æ¨™é”æˆï¼") {
            // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ãŒçµ‚ã‚ã£ã¦ã„ã‚‹å ´åˆ
            startRoulette();
            // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¨ãƒªã‚¢ã‚’éè¡¨ç¤ºã€ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚¨ãƒªã‚¢ã‚’è¡¨ç¤º
            document.getElementById('countdownArea').style.display = 'none';
            document.getElementById('rouletteArea').style.display = 'block';
        } else {
            // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ãŒå‹•ã„ã¦ã„ã‚‹å ´åˆ (SPç‰ˆã§ã¯å†é–‹ãƒœã‚¿ãƒ³ã¨ã—ã¦æ©Ÿèƒ½ã•ã›ã‚‹)
            startCountdown();
            // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¨ãƒªã‚¢ã‚’è¡¨ç¤ºã€ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚¨ãƒªã‚¢ã‚’éè¡¨ç¤º
            document.getElementById('countdownArea').style.display = 'block';
            document.getElementById('rouletteArea').style.display = 'none';
        }
    });
}
</script>

<div class="main-content-area">

    <header class="header">
        <div class="menu-toggle" onclick="toggleMenu()">â˜°</div>
        <a href="counter.html" class="header-title" style="font-size: 1.2em;">ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ (SPç‰ˆ)</a>
    </header>

    <div class="top-ad-header" style="height: 50px;">
        <div id="ad-area-top-sp">
            <script src="https://adm.shinobi.jp/o/b4938a5bb7d245347d3a4f3bf5b38328"></script>
        </div>
    </div>

    <nav class="side-nav" id="sideNav">
        <a href="counter.html">ğŸ“ æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ</a> 
        <a href="roulette.html" class="active-tab">ğŸ² ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</a> 
        <a href="settings.html">âš™ è¨­å®š</a>
        <a href="help.html">ãƒ˜ãƒ«ãƒ—</a>
        <a href="about.html">åˆ¶ä½œè€…</a>
    </nav>
    
    <div class="content-wrapper">

        <h1>ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ»ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³</h1>
        <p style="color: var(--text-soft); margin-top: -10px; font-size: 0.9em;">è¨­å®šã•ã‚ŒãŸç›®æ¨™ã«å‘ã‘ã¦ã€ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã¾ãŸã¯ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’è¡Œã„ã¾ã™ã€‚</p>

        <div class="roulette-container">
            
            <h2>ç¾åœ¨ã®ç›®æ¨™</h2>
            <p id="targetDisplay">ç›®æ¨™æ—¥æ™‚: èª­ã¿è¾¼ã¿ä¸­...</p>

            <div id="countdownArea">
                <p style="font-size: 1em; color: var(--text-soft);">ç›®æ¨™ã¾ã§ã®æ®‹ã‚Šæ™‚é–“</p>
                <div id="countdownValue">èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>

            <div id="rouletteArea" style="display: none;">
                <p style="font-size: 1em; color: var(--text-soft);">ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆçµæœ</p>
                <div id="rouletteResult">â€¦</div>
            </div>
            
            <div id="rouletteAnimation">çµæœå¾…æ©Ÿä¸­</div>

            <button id="startButton">ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³é–‹å§‹</button>

            <div class="settings-link-area">
                <p>ç›®æ¨™ã‚„ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆé …ç›®ã®è¨­å®šã¯<a href="settings.html">è¨­å®šãƒšãƒ¼ã‚¸</a>ã§è¡Œã£ã¦ãã ã•ã„ã€‚</p>
            </div>

        </div>
        
    </div>
</div>

<div class="bottom-ad-footer" style="height: 50px;">
    <div id="ad-area-bottom-sp">
        <script src="https://adm.shinobi.jp/o/b4938a5bb7d245347d3a4f3bf5b38328"></script>
    </div>
</div>

<footer class="footer" style="text-align:center; padding: 20px 0; font-size: 0.8em; color: var(--text-soft);">
    <p>Version <span id="appVersionDisplay"></span></p>
</footer>
</body>
</html>
