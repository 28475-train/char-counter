<!DOCTYPE html>
<html lang="ja" data-view="">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>文字数カウント</title>
<style>
body{font-family:"Noto Sans JP",system-ui,sans-serif;max-width:720px;margin:30px auto;padding:20px}
textarea{width:100%;min-height:160px;padding:12px}
.ad-sp{display:none}.ad-pc{display:block}
html[data-view="sp"] .ad-sp{display:block}
html[data-view="sp"] .ad-pc{display:none}
.settings-btn{position:fixed;bottom:20px;right:20px;
padding:10px 14px;border:none;border-radius:50px;background:#2563eb;color:#fff}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);
display:flex;align-items:center;justify-content:center}
.modal.hidden{display:none}
.box{background:#fff;border-radius:14px;padding:20px;max-width:420px;width:100%}
</style>
</head>
<body>

<h1>文字数カウント</h1>
<textarea id="t"></textarea>
<p>文字数: <span id="c">0</span></p>

<div class="ad-sp"><script src="https://adm.shinobi.jp/s/727078061892c6b6db2f17ceaf739873"></script></div>
<div class="ad-pc"><script src="https://adm.shinobi.jp/s/025d5af8ede4ff475032852f62945fae"></script></div>

<button class="settings-btn" onclick="openSet()">⚙ 設定</button>

<div id="modal" class="modal hidden">
<div class="box">
<h2>ユーザー設定</h2>

<p>表示モード</p>
<label><input type="radio" name="view" value="sp"> スマホ</label><br>
<label><input type="radio" name="view" value="pc"> PC</label>

<p>広告表示 <input type="checkbox" id="ads"></p>

<p id="agreeInfo"></p>

<ul>
<li><a href="terms.html" target="_blank">利用規約</a></li>
<li><a href="terms.html#privacy" target="_blank">プライバシーポリシー</a></li>
</ul>

<button onclick="closeSet()">閉じる</button>
</div>
</div>

<script>
if(localStorage.getItem('agreed')!=='true'){location.href='index.html';}

document.documentElement.setAttribute('data-view',
 localStorage.getItem('viewMode')||'auto');

const t=document.getElementById('t');
const c=document.getElementById('c');
t.oninput=()=>c.textContent=t.value.length;

const modal=document.getElementById('modal');
function openSet(){
 modal.classList.remove('hidden');
 document.querySelectorAll('input[name=view]').forEach(r=>{
  r.checked=r.value===localStorage.getItem('viewMode');
 });
 ads.checked=localStorage.getItem('showAds')!=='false';
 agreeInfo.textContent='同意済み';
}
function closeSet(){modal.classList.add('hidden');}

document.querySelectorAll('input[name=view]').forEach(r=>{
 r.onchange=()=>{
  localStorage.setItem('viewMode',r.value);
  document.documentElement.setAttribute('data-view',r.value);
 };
});
ads.onchange=()=>{
 localStorage.setItem('showAds',ads.checked?'true':'false');
 location.reload();
};
</script>
</body>
</html>
