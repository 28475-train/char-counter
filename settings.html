<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è¨­å®š | ãƒ„ãƒ¼ãƒ«</title>
<link rel="stylesheet" href="style.css">
<style>
/* settings.htmlå°‚ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
body{
  max-width: 720px;
  margin: 30px auto;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
}
.setting-group{
  background: var(--card);
  border-radius: 12px;
  padding: 25px;
  margin-bottom: 25px;
  border: 1px solid var(--border);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}
.setting-group h2{
  color: var(--accent);
  font-size: 1.3em;
  border-bottom: 2px solid var(--accent-light);
  padding-bottom: 12px;
  margin-top: 0;
  margin-bottom: 20px;
}
.setting-item{
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0;
  border-bottom: 1px solid var(--border-soft);
  gap: 15px; 
}
.setting-item:last-child{
  border-bottom: none;
}
.setting-item label {
    flex-grow: 1;
    cursor: pointer;
}
.setting-item input[type="number"],
.setting-item input[type="datetime-local"],
.setting-item select {
    padding: 8px;
    border: 1px solid var(--border);
    border-radius: 6px;
    background-color: var(--background);
    color: var(--text);
    box-sizing: border-box;
}

.theme-options button{
  padding: 8px 12px;
  border: 1px solid var(--border);
  border-radius: 6px;
  cursor: pointer;
  margin-right: 8px;
  font-size: 0.9em;
  background-color: var(--background); 
  color: var(--text); 
  transition: all 0.2s ease;
}
.theme-options button:hover {
    border-color: var(--accent);
    background-color: var(--accent-light);
}
.theme-options button:active {
    transform: translateY(1px);
}

.clear-btn, button[onclick^="save"], button[onclick="clearHistory()"] {
    background-color: var(--accent);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1em;
    font-weight: bold;
    transition: background-color 0.2s;
    margin-left: 10px;
}
.clear-btn:hover, button[onclick^="save"]:hover, button[onclick="clearHistory()"]:hover {
    background-color: var(--accent-dark);
}

.link-list{
  list-style: none;
  padding: 0;
}
.link-list li a{
  display: block;
  padding: 10px 0;
  color: var(--link);
  text-decoration: none;
  border-bottom: 1px dotted var(--border-soft);
  transition: color 0.2s;
}
.link-list li a:hover {
    color: var(--accent);
}

/* å±¥æ­´è¡¨ç¤ºç”¨ */
#historyList div {
    background: var(--background);
    padding: 10px;
    border-radius: 6px;
    margin-bottom: 8px;
    border: 1px solid var(--border-soft);
    font-size: 0.9em;
    white-space: pre-wrap;
    word-break: break-all;
}
</style>
</head>
<body data-theme="light_green">
<script>
// ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®ãƒ†ãƒ¼ãƒé©ç”¨
const body = document.body;
const savedTheme = localStorage.getItem('theme') || 'light_green';
body.setAttribute('data-theme', savedTheme);

function setTheme(theme) {
    body.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
}

// å±¥æ­´é–¢é€£ã®å…±é€šé–¢æ•° (å¾©æ—§)
function getHistory() {
    try {
        const history = localStorage.getItem('textHistory');
        return history ? JSON.parse(history) : [];
    } catch {
        return [];
    }
}
function clearHistory() {
    if (confirm('ã™ã¹ã¦ã®å±¥æ­´ã‚’å®Œå…¨ã«å‰Šé™¤ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
        localStorage.removeItem('textHistory');
        renderHistory();
        alert('å±¥æ­´ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚');
    }
}
function renderHistory() {
    const list = document.getElementById('historyList');
    if (!list) return;
    const history = getHistory();
    list.innerHTML = '';
    
    if (history.length === 0) {
        list.innerHTML = '<p style="color:var(--text-soft);">å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
        return;
    }

    history.forEach((item, index) => {
        const div = document.createElement('div');
        const content = item.length > 50 ? item.substring(0, 50) + '...' : item;
        div.innerHTML = `<strong>${index + 1}.</strong> ${new Date(item.timestamp).toLocaleString()}<br>${content}`;
        list.appendChild(div);
    });
}
</script>

<header class="header">
    <a href="counter.html" class="header-title">ğŸ“ æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ ãƒ„ãƒ¼ãƒ«</a>
    <nav class="header-nav">
        <a href="roulette.html">ğŸ² ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</a> 
        <a href="settings.html">âš™ è¨­å®š</a>
        <a href="help.html">ãƒ˜ãƒ«ãƒ—</a>
        <a href="about.html">åˆ¶ä½œè€…</a>
    </nav>
</header>
<div class="content-wrapper">

<h1>è¨­å®š</h1>

<div class="setting-group">
    <h2>ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ†ãƒ¼ãƒ</h2>
    <div class="setting-item">
        <label>ãƒ†ãƒ¼ãƒã‚’é¸æŠ</label>
        <div class="theme-options">
            <button onclick="setTheme('light_green')">Light Green</button>
            <button onclick="setTheme('dark_blue')">Dark Blue</button>
            <button onclick="setTheme('simple_white')">Simple White</button>
        </div>
    </div>
</div>

<div class="setting-group">
    <h2>è¨ªå•å›æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¨­å®š (counter.html)</h2>
    <div class="setting-item">
        <label for="hideAccessCounter">è¨ªå•å›æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®è¡¨ç¤ºã‚’å®Œå…¨ã«ç„¡åŠ¹ã«ã™ã‚‹</label>
        <input type="checkbox" id="hideAccessCounter">
    </div>
    <div class="setting-item">
        <label for="ignoreAnimation">ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®**ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**ã‚’ç„¡åŠ¹ã«ã™ã‚‹</label>
        <input type="checkbox" id="ignoreAnimation">
    </div>
</div>

<div class="setting-group">
    <h2>ã‚«ã‚¹ã‚¿ãƒ ç›®æ¨™ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¨­å®š (roulette.html)</h2>
    <div class="setting-item">
        <label for="customTargetValue">ç›®æ¨™å›æ•°/ç›®æ¨™å€¤ï¼ˆãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆãƒ»ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³æ™‚ï¼‰</label>
        <input type="number" id="customTargetValue" min="1" value="1000" style="width: 100px;">
    </div>
    <div class="setting-item">
        <label for="customStartDate">é–‹å§‹æ™‚åˆ»ï¼ˆã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—æ™‚ï¼‰</label>
        <input type="datetime-local" id="customStartDate">
    </div>
    <div class="setting-item">
        <label for="customModeSelect">å‹•ä½œãƒ¢ãƒ¼ãƒ‰</label>
        <select id="customModeSelect">
            <option value="none">ç„¡åŠ¹</option>
            <option value="countdown">ç›®æ¨™å€¤ã‹ã‚‰ã®ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ (å›æ•°)</option>
            <option value="countup">é–‹å§‹æ™‚åˆ»ã‹ã‚‰ã®ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ— (æ™‚é–“)</option>
            <option value="roulette">ç›®æ¨™å€¤ã§ã®ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</option>
        </select>
    </div>
    <div style="text-align: right; padding-top: 15px;">
        <button onclick="saveCustomCounterSettings()">è¨­å®šã‚’ä¿å­˜</button>
    </div>
</div>

<div class="setting-group">
    <h2>å…¥åŠ›ãƒ»è¡¨ç¤ºè¨­å®š (counter.html)</h2>
    <div class="setting-item">
        <label for="ignoreSpaces">ã‚¹ãƒšãƒ¼ã‚¹ï¼ˆç©ºç™½ï¼‰ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ãªã„</label>
        <input type="checkbox" id="ignoreSpaces">
    </div>
    <div class="setting-item">
        <label for="hideAds">åºƒå‘Šã®è¡¨ç¤ºã‚’ç„¡åŠ¹ã«ã™ã‚‹</label>
        <input type="checkbox" id="hideAds">
    </div>
    <div class="setting-item">
        <label for="fontSizeSelect">ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º</label>
        <select id="fontSizeSelect">
            <option value="small">å°</option>
            <option value="medium">ä¸­</option>
            <option value="large">å¤§</option>
        </select>
    </div>
    <div style="text-align: right; padding-top: 15px;">
        <button onclick="saveDisplaySettings()">è¡¨ç¤ºè¨­å®šã‚’ä¿å­˜</button>
    </div>
</div>

<div class="setting-group">
    <h2>å±¥æ­´ç®¡ç† (è‡ªå‹•ä¿å­˜ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ)</h2>
    <div id="historyList">
        </div>
    <div style="text-align: right; padding-top: 15px;">
        <button onclick="clearHistory()" style="background-color: #d9534f;">å±¥æ­´ã‚’ã™ã¹ã¦ã‚¯ãƒªã‚¢</button>
    </div>
</div>

</div>

<script>
// === è¨ªå•å›æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¨­å®šã®å‡¦ç† (æ—¢å­˜) ===
const ignoreAnimationCheckbox = document.getElementById('ignoreAnimation');
const hideAccessCounterCheckbox = document.getElementById('hideAccessCounter');

// ãƒ­ãƒ¼ãƒ‰
if (localStorage.getItem('ignoreAnimation') === 'true') ignoreAnimationCheckbox.checked = true;
if (localStorage.getItem('hideAccessCounter') === 'true') hideAccessCounterCheckbox.checked = true;

// ä¿å­˜ (ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã¯çœç•¥ã€æ‰‹å‹•ã§ä¿å­˜ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã‚’åˆ¥é€”å®šç¾©)


// === å…¥åŠ›ãƒ»è¡¨ç¤ºè¨­å®šã®å‡¦ç† (æ–°è¦/å¾©æ—§) ===
const ignoreSpacesCheckbox = document.getElementById('ignoreSpaces');
const hideAdsCheckbox = document.getElementById('hideAds');
const fontSizeSelect = document.getElementById('fontSizeSelect');

function loadDisplaySettings() {
    if (localStorage.getItem('ignoreSpaces') === 'true') ignoreSpacesCheckbox.checked = true;
    if (localStorage.getItem('hideAds') === 'true') hideAdsCheckbox.checked = true;
    fontSizeSelect.value = localStorage.getItem('fontSize') || 'medium';
}

function saveDisplaySettings() {
    localStorage.setItem('ignoreSpaces', ignoreSpacesCheckbox.checked);
    localStorage.setItem('hideAds', hideAdsCheckbox.checked);
    localStorage.setItem('fontSize', fontSizeSelect.value);
    
    // counter.htmlã®ãƒ•ã‚©ãƒ³ãƒˆã‚’å³åº§ã«æ›´æ–° (ã“ã“ã§document.bodyã«é©ç”¨)
    document.body.setAttribute('data-font', fontSizeSelect.value);
    alert('è¡¨ç¤ºè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚');
}


// === ã‚«ã‚¹ã‚¿ãƒ ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¨­å®šã®å‡¦ç† (roulette.htmlç”¨) (æ—¢å­˜) ===
const customTargetValueInput = document.getElementById('customTargetValue');
const customStartDateInput = document.getElementById('customStartDate');
const customModeSelect = document.getElementById('customModeSelect');

function loadCustomCounterUISettings() {
    const savedSettings = localStorage.getItem('customCounterSettings');
    let settings = {};

    if (savedSettings) {
        settings = JSON.parse(savedSettings);
        
        customTargetValueInput.value = settings.target || 1000;
        customModeSelect.value = settings.mode || 'none';
        
        if (settings.start) {
            try {
                const date = new Date(settings.start);
                const localDateString = date.toLocaleString('sv-SE').substring(0, 16).replace(' ', 'T');
                customStartDateInput.value = localDateString;
            } catch(e) {
                console.error("æ—¥æ™‚è¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:", e);
                customStartDateInput.value = '';
            }
        }
    } 
    
    if (!customStartDateInput.value) {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hour = String(now.getHours()).padStart(2, '0');
        const minute = String(now.getMinutes()).padStart(2, '0');
        customStartDateInput.value = `${year}-${month}-${day}T${hour}:${minute}`;
    }
}

function saveCustomCounterSettings() {
    const targetValue = parseInt(customTargetValueInput.value, 10);
    const mode = customModeSelect.value;
    
    if ((mode === 'countdown' || mode === 'roulette') && (isNaN(targetValue) || targetValue <= 0)) {
        alert("ç›®æ¨™å€¤ã«ã¯1ä»¥ä¸Šã®æœ‰åŠ¹ãªæ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        return;
    }

    const selectedDateTime = customStartDateInput.value;
    
    const newSettings = {
        target: targetValue,
        start: selectedDateTime ? new Date(selectedDateTime).toISOString() : null, 
        mode: mode
    };

    localStorage.setItem('customCounterSettings', JSON.stringify(newSettings));
    alert('ã‚«ã‚¹ã‚¿ãƒ ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚roulette.html ã§åæ˜ ã•ã‚Œã¾ã™ã€‚');
    loadCustomCounterUISettings(); 
}

// === ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸåŒ– ===
window.addEventListener('load', () => {
    // æ—¢å­˜ã®è¨­å®šé …ç›®ã‚’ãƒ­ãƒ¼ãƒ‰
    if (localStorage.getItem('ignoreAnimation') === 'true') ignoreAnimationCheckbox.checked = true;
    if (localStorage.getItem('hideAccessCounter') === 'true') hideAccessCounterCheckbox.checked = true;
    
    // æ–°è¦/å¾©æ—§ã—ãŸè¨­å®šé …ç›®ã‚’ãƒ­ãƒ¼ãƒ‰
    loadDisplaySettings();
    loadCustomCounterUISettings();
    renderHistory(); // å±¥æ­´ã®è¡¨ç¤º
});


// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¿½åŠ 
document.querySelector('button[onclick="saveDisplaySettings()"]').addEventListener('click', saveDisplaySettings);
document.querySelector('button[onclick="saveCustomCounterSettings()"]').addEventListener('click', saveCustomCounterSettings);

// è¨ªå•å›æ•°ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼é–¢é€£ã®ä¿å­˜ãƒœã‚¿ãƒ³ãŒãªã„ãŸã‚ã€ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å¤‰æ›´æ™‚ã«ä¿å­˜
ignoreAnimationCheckbox.addEventListener('change', function() {
    localStorage.setItem('ignoreAnimation', this.checked);
});
hideAccessCounterCheckbox.addEventListener('change', function() {
    localStorage.setItem('hideAccessCounter', this.checked);
});
</script>
</body>
</html>
